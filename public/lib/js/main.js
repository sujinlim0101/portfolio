'use strict';(function(){function checkNav(){44<yOffset?document.body.classList.add('nav-sticky'):document.body.classList.remove('nav-sticky')}function setLayout(){for(var i=0;i<sceneInfo.length;i++)'normal'===sceneInfo[i].type?sceneInfo[i].scrollHeight=sceneInfo[i].objs.container.offsetHeight:(sceneInfo[i].scrollHeight=sceneInfo[i].heightNum*window.innerHeight,sceneInfo[i].objs.container.style.height=sceneInfo[i].scrollHeight+'px');var totalScrollHeight=0;yOffset=window.pageYOffset;for(var _i=0;_i<sceneInfo.length;_i++)if(totalScrollHeight+=sceneInfo[_i].scrollHeight,totalScrollHeight>=yOffset){currentScene=_i;break}document.body.setAttribute('id','show-scene-'+currentScene);var heightRatio=document.documentElement.clientHeight/1080;sceneInfo[0].objs.canvas.style.transform='translate3d(-50%, -50%, 0) scale('+heightRatio+')'}function playAnimation(){var objs=sceneInfo[currentScene].objs,values=sceneInfo[currentScene].values,currentYOffset=yOffset-prevScrollHeight,scrollHeight=sceneInfo[currentScene].scrollHeight,scrollRatio=(yOffset-prevScrollHeight)/sceneInfo[currentScene].scrollHeight;switch(currentScene){case 0:var sequence=Math.round(calcValues(values.imgaeSequence,currentYOffset));objs.context.drawImage(objs.videoImages[sequence],0,0),.22>=scrollRatio?(objs.messageA.style.opacity=calcValues(values.messageA_opacity_in,currentYOffset),objs.messageA.style.transform='translate3d(0, '+calcValues(values.messageA_translateY_in,currentYOffset)+'%, 0)'):(objs.messageA.style.opacity=calcValues(values.messageA_opacity_out,currentYOffset),objs.messageA.style.transform='translate3d(0, '+calcValues(values.messageA_translateY_out,currentYOffset)+'%, 0)'),.42>=scrollRatio?(objs.messageB.style.opacity=calcValues(values.messageB_opacity_in,currentYOffset),objs.messageB.style.transform='translate3d(0, '+calcValues(values.messageB_translateY_in,currentYOffset)+'%, 0)'):(objs.messageB.style.opacity=calcValues(values.messageB_opacity_out,currentYOffset),objs.messageB.style.transform='translate3d(0, '+calcValues(values.messageB_translateY_out,currentYOffset)+'%, 0)'),.62>=scrollRatio?(objs.messageC.style.opacity=calcValues(values.messageC_opacity_in,currentYOffset),objs.messageC.style.transform='translate3d(0, '+calcValues(values.messageC_translateY_in,currentYOffset)+'%, 0)'):(objs.messageC.style.opacity=calcValues(values.messageC_opacity_out,currentYOffset),objs.messageC.style.transform='translate3d(0, '+calcValues(values.messageC_translateY_out,currentYOffset)+'%, 0)'),.82>=scrollRatio?(objs.messageD.style.opacity=calcValues(values.messageD_opacity_in,currentYOffset),objs.messageD.style.transform='translate3d(0, '+calcValues(values.messageD_translateY_in,currentYOffset)+'%, 0)'):(objs.messageD.style.opacity=calcValues(values.messageD_opacity_out,currentYOffset),objs.messageD.style.transform='translate3d(0, '+calcValues(values.messageD_translateY_out,currentYOffset)+'%, 0)');break;case 4:.8<scrollRatio&&(objs.container.style.background='white');}}function calcValues(values,currentYOffset){var rv=void 0,scrollHeight=sceneInfo[currentScene].scrollHeight,scrollRatio=currentYOffset/sceneInfo[currentScene].scrollHeight;if(3===values.length){var partScrollStart=values[2].start*scrollHeight,partScrollEnd=values[2].end*scrollHeight;currentYOffset>=partScrollStart&&currentYOffset<=partScrollEnd?rv=(currentYOffset-partScrollStart)/(partScrollEnd-partScrollStart)*(values[1]-values[0])+values[0]:currentYOffset<partScrollStart?rv=values[0]:currentYOffset>partScrollEnd&&(rv=values[1])}else rv=scrollRatio*(values[1]-values[0])+values[0];return rv}function scrollLoop(){enterNewScene=!1,yOffset=window.pageYOffset,prevScrollHeight=0;for(var i=0;i<currentScene;i++)prevScrollHeight+=sceneInfo[i].scrollHeight;if(yOffset>prevScrollHeight+sceneInfo[currentScene].scrollHeight&&(enterNewScene=!0,currentScene++),yOffset<prevScrollHeight){if(0===currentScene)return;enterNewScene=!0,currentScene--}document.body.setAttribute('id','show-scene-'+currentScene),enterNewScene||playAnimation()}var yOffset=0,prevScrollHeight=0,currentScene=0,enterNewScene=void 0,transitionContainer=document.querySelector('#transition-container'),sceneInfo=[{type:'sticky',heightNum:5,scrollHeight:0,objs:{container:document.querySelector('#scroll-section-0'),messageA:document.querySelector('.main-message.a'),messageB:document.querySelector('.main-message.b'),messageC:document.querySelector('.main-message.c'),messageD:document.querySelector('.main-message.d'),canvas:document.querySelector('#video-canvas-0'),context:document.querySelector('#video-canvas-0').getContext('2d'),videoImages:[]},values:{videoImageCount:72,imgaeSequence:[0,71],canvas_opacity:[1,0,{start:.9,end:1}],messageA_opacity_in:[0,1,{start:.1,end:.2}],messageB_opacity_in:[0,1,{start:.3,end:.4}],messageC_opacity_in:[0,1,{start:.5,end:.6}],messageD_opacity_in:[0,1,{start:.7,end:.8}],messageA_translateY_in:[20,0,{start:.1,end:.2}],messageB_translateY_in:[20,0,{start:.3,end:.4}],messageC_translateY_in:[20,0,{start:.5,end:.6}],messageD_translateY_in:[20,0,{start:.7,end:.8}],messageA_opacity_out:[1,0,{start:.25,end:.3}],messageB_opacity_out:[1,0,{start:.45,end:.5}],messageC_opacity_out:[1,0,{start:.65,end:.7}],messageD_opacity_out:[1,0,{start:.85,end:.9}],messageA_translateY_out:[0,-20,{start:.25,end:.3}],messageB_translateY_out:[0,-20,{start:.45,end:.5}],messageC_translateY_out:[0,-20,{start:.65,end:.7}],messageD_translateY_out:[0,-20,{start:.85,end:.9}]}},{type:'sticky',heightNum:1,scrollHeight:0,objs:{container:document.querySelector('#scroll-section-1')},values:{}},{type:'normal',objs:{container:document.querySelector('#scroll-section-2')}},{type:'normal',objs:{container:document.querySelector('#scroll-section-3')}},{type:'normal',objs:{container:document.querySelector('#scroll-section-4')}},{type:'normal',scrollHeight:0,objs:{container:document.querySelector('#scroll-section-5')}}];window.addEventListener('load',function(){document.body.classList.remove('before-load'),setLayout(),sceneInfo[0].objs.context.drawImage(sceneInfo[0].objs.videoImages[0],0,0)}),window.addEventListener('scroll',function(){scrollLoop(),checkNav()}),window.addEventListener('resize',setLayout),window.addEventListener('orientationchange',function(){setTimeout(setLayout,500)}),document.querySelector('.loading').addEventListener('transitionend',function(e){document.querySelector('.loading')&&document.body.removeChild(e.currentTarget)}),function(){for(var imgElem=void 0,i=1;i<sceneInfo[0].values.videoImageCount+1;i++)imgElem=new Image,imgElem.src=10>i?'public/src/images/001/000'+i+'.jpg':100>i?'public/src/images/001/00'+i+'.jpg':'public/src/images/001/0'+i+'.jpg',sceneInfo[0].objs.videoImages.push(imgElem)}()})();